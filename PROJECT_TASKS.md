# 七圣召唤项目任务列表

## 项目概述

本项目旨在实现一个完整的七圣召唤（Genshin Impact Card Game）游戏系统，包括游戏引擎、卡牌系统、用户认证、API接口和测试套件。

## 当前开发阶段

**阶段2.5：测试与完善** (已完成)
- [x] 完善集成测试套件
- [x] 修复API路由问题
- [x] 优化游戏引擎逻辑
- [x] 实现完整的回合流程

**阶段3：前端UI开发** (进行中)
- [ ] 前端环境准备
- [ ] 基础前端UI
- [ ] 完整游戏界面

## 已完成任务

### 基础架构
- [x] 环境搭建：Python 3.12+、Flask、SQLAlchemy等
- [x] 依赖初始化：通过uv或pip安装后端依赖
- [x] 代码仓库初始化
- [x] 项目目录结构创建

### 数据模型
- [x] 创建models/enums.py，定义所有枚举类型
- [x] 创建models/game_models.py，实现核心数据类
- [x] 创建models/db_models.py，定义数据库模型
- [x] 数据导入：导入519张卡牌数据

### 用户系统
- [x] 实现api/auth.py，完成用户注册、登录、获取个人信息的API
- [x] 集成JWT令牌认证

### 游戏引擎
- [x] 创建game_engine/core.py，实现GameEngine类
- [x] 实现核心方法：create_game_state, process_action, _roll_phase, _action_phase, _end_phase
- [x] 实现基础动作处理逻辑
- [x] 实现基础的费用支付和验证逻辑

### API接口
- [x] 实现api/cards.py，提供卡牌相关端点
- [x] 实现api/local_game.py，提供本地游戏API
- [x] 使用内存字典存储单人游戏会话状态
- [x] 实现健康检查和API测试页面

### 测试套件
- [x] 完善集成测试套件
- [x] 创建API测试指南
- [x] 实现自动化测试流程

## 待完成任务

### 高优先级

#### 游戏核心机制
- [ ] 实现元素反应系统
  - [ ] 元素附着机制
  - [ ] 各种元素反应效果（融化、蒸发、超载等）
  - [ ] 伤害计算整合
- [ ] 完善角色击倒逻辑
  - [ ] 角色击倒判定
  - [ ] 胜利条件实现
  - [ ] 15回合平局处理
- [ ] 修正行动类型规则
  - [ ] 快速行动与战斗行动区分
  - [ ] 打出手牌应为快速行动
  - [ ] 元素调和功能实现

#### 卡组验证
- [ ] 实现完整的卡组构筑验证
  - [ ] 角色牌/行动牌数量验证（3+30）
  - [ ] 同名牌数量限制（最多2张，秘传牌1张）
  - [ ] 天赋牌、元素共鸣牌、国家牌构筑限制

### 中优先级

#### 特殊游戏机制
- [ ] 实现手牌替换机制（初始5张手牌替换）
- [ ] 实现重击和下落攻击机制
- [ ] 实现特殊状态效果（冻结、护盾、饱腹等）
- [ ] 实现结算顺序规则

#### 前端开发
- [ ] 创建前端目录结构，初始化React TypeScript项目
- [ ] 安装前端依赖（Redux Toolkit, React Redux, Socket.io-client等）
- [ ] 配置基础类型定义、Redux store、API和WebSocket服务
- [ ] 搭建GameBoard.tsx的基本布局
- [ ] 创建Card.tsx组件，用于展示卡牌信息

### 低优先级

#### 多人游戏
- [ ] 集成Flask-SocketIO到后端
- [ ] 实现房间管理逻辑
- [ ] 实现匹配系统
- [ ] 支持观战功能

#### AI对手
- [ ] 设计基础AI策略
- [ ] 实现不同难度等级的AI对手
- [ ] 集成AI到游戏引擎中

#### 数据持久化
- [ ] 实现游戏状态恢复功能
- [ ] 将对局结果写入数据库
- [ ] 更新玩家的胜/负统计数据

## 风险评估

### 高风险
- **元素反应系统复杂性**：需要精确实现各种元素反应的复杂逻辑
- **性能问题**：复杂计算可能影响游戏性能

### 中风险
- **规则实现完整性**：确保所有规则都被正确实现
- **边界情况处理**：处理各种特殊情况

### 低风险
- **API兼容性**：与前端集成的兼容性问题

## 里程碑计划

### 里程碑1 (已完成): 基础架构完善
- 完成基础架构搭建
- 实现核心数据模型
- 完成用户认证系统
- 实现基础游戏引擎

### 里程碑2 (进行中): 游戏核心机制
- 完成元素反应系统
- 完成角色击倒和胜利判定
- 完善行动类型规则
- 通过核心机制测试

### 里程碑3 (计划中): 前端UI开发
- 完成基础前端界面
- 实现游戏板布局
- 集成API调用
- 通过UI功能测试

### 里程碑4 (计划中): 多人游戏支持
- 完成WebSocket集成
- 实现匹配系统
- 支持观战功能
- 通过多人游戏测试

## 资源需求

### 人力资源
- **主开发**: 1名高级Python开发工程师
- **前端开发**: 1名React开发工程师
- **测试**: 1名测试工程师

### 硬件资源
- 开发工作站 (推荐配置: 16GB+ RAM, 多核处理器)
- 测试服务器 (用于API测试)

### 时间资源
- 总开发时间: 15周
- 每日开发时间: 6-8小时
- 里程碑评估: 每周一次